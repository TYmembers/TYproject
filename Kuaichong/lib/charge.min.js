$(document).ready(function(){function e(){isPhone(n.phoneNumber.val())?(n.numberBefore.hide(),$.ajax({method:"get",url:"http://apis.baidu.com/apistore/mobilephoneservice/mobilephone",headers:{apikey:"0232aa12434e9773e9cfaac7ffafddcf"},data:{tel:n.phoneNumber.val()},datatype:"json",success:function(e){var t=JSON.parse(e);if("success"==t.errMsg){var i=t.retData;n.type.text("用户绑定号码"+i.carrier).show(),localStorage.setItem("carrier",i.carrier),localStorage.setItem("phoneNumber",n.phoneNumber.val())}else createAlert(tip[3])}})):createAlert(tip[1])}var n={};n.phoneNumber=$("#rechange-phonenumber"),n.type=$("#mobile-type"),n.changeBtn=$("#changenumber"),n.numberBefore=$(".push>.phoneNumber"),n.time=$(".checkbox>li"),n.icon=$(".checkbox>li>i"),n.price=$(".push .moneyList a"),n.phoneNumber.val(localStorage.loginNumber),n.changeBtn.bind("click",function(){n.type.hide(),n.phoneNumber.css({color:"#ccc",fontSize:"1.2rem"}).val(localStorage.loginNumber).focus(function(){$(this).val("").css({color:"#555",fontSize:"1.3rem"})}),$.ajax({method:"post",url:"../json/numbefore.json",data:{tel:n.phoneNumber.val()},datatype:"json",success:function(e){if(1==e.code){var t=e.content;$.each(t,function(e){n.newli=$("<li class='newli'></li>"),n.newli.text(t[e].tel),n.numberBefore.append(n.newli)}),n.lastli=$("<li class='clearnum'>清空历史充值号码</li>"),n.numberBefore.append(n.lastli),n.numberBefore.show(),n.linum=$(".push>.phoneNumber>li.newli"),n.linum.bind("click",function(){n.phoneNumber.val($(this).text()),n.numberBefore.remove($(this).children()).hide()}),n.lastli.bind("click",function(){$(this).parent().remove($(this).children()).hide()})}else n.numberBefore.hide()}})}),11==n.phoneNumber.val().length?e():e=null,n.phoneNumber[0].onkeyup=function(){11==n.phoneNumber.val().length&&e()},n.icon.bind("click",function(){$(this).children("span").toggleClass("disc").parents("li").siblings("li").children("i").children("span").removeClass("disc"),localStorage.setItem("howlong",$(this).siblings("span").text())}),n.price.bind("click",function(e){n.icon.children("span").hasClass("disc")?(e.preventDefault(),localStorage.setItem("howmuch",$(this).children("h4").children("span").text()),localStorage.setItem("discount",$(this).children("p").children("span").text()),$(this).toggleClass("active").siblings("a").removeClass("active"),location.href="../webhtml/pay.html"):($(this).removeAttr("href"),createAlert(tip[2]))})});